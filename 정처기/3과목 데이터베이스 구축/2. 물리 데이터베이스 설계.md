# 2. 물리 데이터베이스 설계

## 85) 사전 조사 분석(B)

### 물리 데이터베이스 설계

: 논리적 구조로 표현된 논리적 데이터베이스를 디스크 등의 물리적 저장정치에 저장할 수 있는 물리적 구조의 데이터로 변환하는 과정

- 물리 데이터베이스 구조의 기본적인 데이터 단위는 저장 레코드(Stored Record)이다.

- 물리적 설계 단계에서 꼭 포함되어야 할 것은 저장 레코드의 양식 설계, 레코드 집중(Record Clustering)의 분석 및 설계 , 접근 경로 설계 등이다.

- 여러 가지 타입의 저장 레코드 집합이라는 면에서 단순한 파이로가 다르다.

- 데이터 베이스 시스템의 성능에 중대한 영향을 미친다

- 물리적 설계 시 고려 사항

  - 인덱스 구조
  - 레코드 크기
  - 파일에 존재하는 레코드 개수
  - 파일에 대한 트랜잭션의 갱신과 참조 성향
  - 성능 향상을 위한 개념 스키마의 변경 여부 검토
  - 빈번한 질의와 트랜잭션들의 수행속도를 높이기 위한 고려
  - 시스템 운용 시 파일 크기의 변화 가능성

- 물리적 설계 전에 기존 시스템을 분석하여 데이터 명명 규칙, 시스템 자원, 데이터 베이스 관리 요소 등을 파악해야 한다.

- 물리적 설계 옵션

  - 반응 시간(Response Time)

    : 트랜잭션 수행을 요구한 시점부터 처리 결과를 얻을때까지의 경과 시간

  - 공간 활용도(Space Utilzation)

    : 데이터베이스 파일과 액세스 경로 구조에 의해 사용되는 저장 공간의 양

  - 트랜잭션 처리량(Transaction Throughput)

    : 단위시간 동안 데이터베이스 시스템에 의해 처리될 수 있는 트랜잭션의 평균 개수



### 데이터 명명 규칙 파악

: 물리 데이터 모델에 적용해야 하는 규칙으로, 조직마다 다를 수 있으므로 물리 데이터 모델의 설계 전에 파악해야 한다.

- 데이터 표준화 및 논리 데이터베이스 설계의 결과물 등을 통해 파악

- 물리 데이터베이스 설계와 논리 데이터베이스 설계에 적용되는 명명 규칙은 서로 일관성을 유지해야 한다.

- 논리적 데이터 요소를 물리적 데이터 요소로 전환할 떄 동일 명칭 부여의 근거로 사용

- 중복 구축 등을 방지할 수 있다.

- 도메인과 데이터 사전에 대한 지식이 필요

- <b>도메인</b>

  : 객체에 포함된 속성들의 데이터 타입, 크기 등을 표준화 규칙에 따라 일관성 있게 정의한 것을 의미

- <b>데이터 사전(데이터 용어 사전)</b>

  - 전체 프로젝트 과정에서 일관성 있는 데이터 이름과 인터페이스를 제공하기 위해 데이터 속성의 논리명(Logical Name), 물리명(Physical Name), 용어 정의(Definition)를 기술해 놓은 것이다.
  - 데이터 사전은 프로젝트에서 사용하는 명칭 부여의 근거로 사용



### 시스템 자원 파악

: 데이터베이스 설치에 영향을 미칠 수 있는 물리적인 요소들로, 사전에 미리 파악해야 한다.

- 시스템 자원은 하드웨어 자원, 운영체제 및 DBMS 버전, DBMS 파라미터 정보 등으로 구분한다

#### 하드웨어 자원

- 중앙처리장치

  : 중앙 처리 장치(CPU)의 성능과 집중적인 부하 발생시간 등을 파악

- 메모리

  : 시스템의 전체 메모리 규모, 사용 중인 메모리 영역, 사용 중인 메모리 영역, 사용 가능한 메모리 영역 등 확보된 자원이나 실질적인 시스템 활용 정도 등을 파악

- 디스크

  : 전체 디스크의 크기, 확보된 디스크 자원, 디스크 분할 형태, 현재 디스크 활용률, 사용 가능한 디스크 공간 등을 파악

- I/O Controller

  : 현행 시스템의 입출력 컨트롤러의 성능, 우뇽ㅇ의 적설성 등을 파악

- 네트워크

  : 네트워크의  처리량, 처리 속도, 집중적인 부하 발생 시간, 동시 접속 가능 정도 등을 파악

#### 운영체제 및 DBMS 버전

: 운영체제와 DBMS 버전은 데이터베이스 운영에 영향을 미칠 수 있으므로 관련 요소 등을 파악하고 적절하게 관리해야 한다.

#### DBMS 파라미터(Parameter) 정보

- DBMS 파라미터는 데이터베이스 관리 시스템별로 차이가 많고 관리 방법도 제각각이므로 시스템별 DBMS 파라미터의 종류 및 관리 대상 등을 파악
- DBMS의 저장 공간, 메모리 등에 대한 파라미터, 쿼리에서 활용하는 옵티마이저의 사용방법 등을 파악
  - 옵티마이저 : SQL문을 수행할 가장 효율적이고 빠른 방법을 선택해주는 DBMS의 핵심 엔진



### 데이터베이스 관리 요소 파악

: 데이터베이스 운영과 관련된 관리 요소로, 데이터베이스 시스템의 환경에 따라 달라질 수 있으므로 미리 파악해야 한다.

- 데이터베이스 관리 요소를 파악한 후 이를 기반으로 데이터베이스 시스템 조사 분석서를 작성

- 시스템 조사 분석서를 기반으로 데이터베이스 구조, 이중화 구성, 분산 데이터베이스, 접근제어/접근통제, DB암호화 등의 범위와 특성을 파악

  - 데이터베이스 구조

    : 데이터베이스의 구조에 따라 문제 발생 시 대응방법이 다르므로 서버와 데이터베이스 구조 등을 파악

  - 이중화 구성

    : 문제 발생에 대비하여 동일한 데이터베이스를 복제하여 관리하는 이중화 구성을 파악

  - 분산 데이터베이스

    -  물리적 재해 및 파손 등 데이터 유실을 최소화
    - 장애로 인한 데이터 유실 복구에 효과적이므로 데이터베이스의 분산 구조를 파악

  - 접근 제어/접근 통제

    : 데이터베이스는 접근 가능한 사용자의 권한 남용으로 인한 정보 유출 및 변조가 가장 빈번하게 발생하므로 데이터베이스의 접근 제어 방법 등을 파악

  - DB암호화

    : 데이터 암호화, 암호 키에 대한 인증 등을 통해 데이터 유출 시 데이터의 복호화를 어렵게 하므로 DB암호화의 특성을 파악



## 86) 데이터베이스 저장 공간 설계(B)

### 테이블(Table)

: 데이터베이스의 가장 기본적인 객체로 로우(Row, 행)와 컬럼(Column, 열)으로 구성되어 있다.

- 데이터베이스의 모든 데이터는 테이블에 저장
- 논리 설계 단계의 개체(Entity)에 대응하는 객체
- DBMS 종류에 따라 테이블의 명칭과 기능 등은 약간씩 차이가 있다.
- 테이블의 종류에는 일반 테이블, 클러스터 인덱스 테이블, 파티셔닝 테이블, 외부 테이블, 임시 테이블 등이 있다.



### 일반 테이블

: 현재 사용되는 대부분의 DBMS에서 표준 테이블로 사용되는 테이블 형태

- 저장되는 데이터의 로우 위치는 속성 값에 상관없이 데이터가 저장되는 순서에 따라 결정



### 클러스터드 인덱스 테이블(Clustered Index Table)

: 기본키(Primary Key)나 인덱스키의 순서에 따라 데이터가 저장되는 테이블이다.

- 일반적인 인덱스를 사용하는 테이블에 비해 접근 경로가 단축



### 파티셔닝 테이블(Partitioning Table)

: 대용량의 테이블을 작은 논리적 단위인 파티션(Partition)으로 나눈 테이블이다.

- 대용량의 데이터를 효과적으로 관리할 수 있지만 파티션 키를 잘못 구성하면 성능 저하 등의 역효과를 초래할 수 있다.
- 파티셔닝 방식에 따라 범위 분할(Range Partitioning), 해시 분할(Hash Partitioning), 조합 분할(Composite Partitioning) 등으로 나뉜다.
  - 범위 분할 : 지정한 열의 값을 기준으로 분할
  - 해시 분할 : 해시 함수를 적용한 결과 값에 따라 분할
  - 조합 분할 : 범위 분할로 분할한 다음 해시 함수를 적용하여 다시 분할하는 방식



### 외부 테이블(External Table)

: 데이터베이스에서 일반 테이블처럼 이용할 수 있는 외부 파일로, 데이터베이스 내에 객체로 존재

- 데이터웨어하우스(Date Warehouse)에서 ETL(Extraction, Transformation, Loading) 등의 작업에 유용하게 사용



### 임시 테이블(Temporary Table)

: 트랜잭션이나 세션별로 데이터를 저장하고 처리할 수 있는 테이블

- 임시 테이블에 저장된 데이터는 트랜잭션이 종료되면 삭제된다.
- 절차적인 처리를 위해 임시로 사용하는 테이블



### 컬럼(Column)

: 테이블의 열을 구성하는 요소로 데이터 타입, 길이 등으로 정의

- 데이터의 일관성 유지를 위해 사용되는 가장 기본적인 것으로, 도메인을 정의한 경우 도메인에 따라 데이터의 타입과 길이가 정의
- 두 컬럼을 비교하는 연산에서 데이터 타입이나 길이가 다르면 DBMS 내부적으로 데이터 타입을 변환한 후 비교 연산을 수행
- 참조 관계인 컬럼들은 데이터 타입과 길이가 일치해야 한다.
- 데이터 타입과 길이 지정 시 고려 사항
  - 가변 길이 데이터 타입 : 예상되는 최대 길이로 정의
  - 고정 길이 데이터 타입 : 최소 길이로 지정
  - 소수점 이하 자릿수 : 소수점 이하 자릿수는 반올림되어 저장
- 데이터 타입에 따른 컬럼의 물리적인 순서
  - 고정 길이 컬럼이고 NOT Null인 컬럼 : 앞쪽
  - 가변 길이 컬럼 : 뒤쪽
  - Null 값이 많을 것으로 예상되는 컬럼 : 뒤쪽



### 테이블스페이스(Tablespace)

: 테이블이 저장되는 논리적인 영역으로, 하나의 테이블스페이스에 하나 또는 그 이상의 테이블을 저장할 수 있다.

- 테이블을 저장하면 논리적으로는 테이블스페이스에 저장되고, 물리적으로는 해당 테이블스페이스와 연관된 데이터 파일에 저장
- 데이터베이스를 테이블, 테이블스페이스, 데이터 파일로 나눠 관리하면 논리적 구성 물리적 구성에 종속되지 않아 투명성이 보장
- 데이터베이스에 저장되는 내용에 따라 테이블, 인덱스, 임시 등으 ㅣ용도로 구분하여 설계
- 테이블스페이스 설계시 고려 사항
  - 업무별로 구분하여 지정
  - 대용량 테이블은 하나의 테이블스페이스에 독립적으로 저장
  - 테이블과 인덱스는 분리하여 저장
  - LOB(Large Object) 타입의 데이터는 독립적인 공간으로 지정



## 트랜잭션 분석 / CRUD 분석

### 트랜잭션(Transaction) 정의

: 데이터베이스의 상태를 변화시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위 또는 한꺼번에 모두 수행되어야 할 일련의 연산들을 의미

- 데이터베이스 시스템에서 병행 제어 및 회복 작업 시 처리되는 작업의 논리적 단위로 사용
- 사용자가 시스템에 대한 서비스 요구 시 시스템이 응답하기 위한 상태 변환 과정의 작업 단위로 사용



### 트랜잭션의 특징

데이터 무결성을 보장하기 위해 DBMS의 트랜잭션이 가져야할 특성

- Atomicity(원자성)
  - 데이터베이스에 모두 반영되도록 완료되든지 아니면 전혀 반영되지 않도록 복구 되어야 한다.
  - 트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 어느 하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 한다.
- Comsistency(일관성)
  - 트랜잭션이 실행을 성공적으로 완료하면 언제나 일관성 있는 데이터베이스 상태로 변환한다.
  - 시스템이 가지고 있는 고정 요소는 트랜잭션 수행 전과 트랜잭션 수행 완료 후의 상태가 같아야 한다.
- Isoation(독립성, 격리성, 순차성)
  - 둘 이상의 트랜잭션이 동시에 병행 실행되는 경우 어느 하나의 트랜잭션 실행중에 다른 트랜잭션의 연산이 끼어들 수 없다.
  - 수행중인 트랜잭션은 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조할 수 없다.
- Durability(영속성, 지속성)
  - 성공적으로 완료된 트랜잭션의 결과는 시스템이 고장나더라도 영구적으로 반영되어야 한다.



### CRUD 분석

: 생성(Create), 읽기(Read), 갱신(Update), 삭제(Delete)를 의미하며, CRUD 분석은 데이터베이스 테이블에 변화를 주는 트랜잭션의 연산에 대해 CRUD 매트릭스를 작성하여 분석하는 것

- 테이블에 발생되는 트랜잭션의 주기별 발생 횟수를 파악하고 연관된 테이블들을 분석하면 테이블에 저장되는 데이터의 양을 유추 가능
- 많은 트랜잭션이 몰리는 테이블을 파악할 수 있으므로 디스크 구성 시 유용한 자료로 활용 가능
- 외부 프로세스 트랜잭션의 부하가 집중되는 데이터베이스 채널을 파악하고 분산시키으로써 연결 지연이나 타임아웃 오류를 방지할 수 있다.



###  CRUD 매트릭스



















